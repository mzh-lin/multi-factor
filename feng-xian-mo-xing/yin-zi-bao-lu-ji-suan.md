# 因子暴露计算

我们希望可以针对不同因子进行比较和回归，因此我们需要调整因子的量纲，主要的处理方式包括：

* 去极值
* 标准化
* 缺失值处理

一般而言，上述三个方法存在先后顺序，处理缺失值可以放置在最前或者最后，根据具体因子确定。



#### 缺失值处理

##### 小类因子缺失

如果小类因子缺失，不做处理，在合成大类因子时，将有值的小类因子权重按比例调整到和为1，再计算大类因子。但是如果大类因子下的所有小类因子均没有值则大类因子缺失。

##### 大类因子缺失

针对**财务类因子缺失**，如EarningsYield,Leverage等，按行业平均进行填值；

针对**市场类因子缺失**，如Momentum, Liquidity等，按回归的方式填值：若A因子缺失，则将A作为因变量，其他所有的因子作为自变量进行回归，然后用回归结果来拟合A因子的暴露。原因在于我们认为行业、市值或者其他属性相似的股票会有相似的因子暴露。



#### 去极值

较为传统去极值的方法有3 倍标准差法和中位数法。在BARRA 的风险模型中，普遍采用3 倍标准差法，但是我们研究发现，3 倍标准差法在处理分布偏度较大的因子截面时，仍然会产生异常结果影响回归方程的稳定性，因此我们使用中位数法剔除因子异常值。

对于一个截面的样本$x_i,i=1,2,\dots,n$，首先求中位数, $x_{median}=median(x_i)$，然后求所有样本点距离$x_{median}$的中位数, $MAD = median(x_i-x_{median})$. 将超出$x_{median}\pm5MAD$的数据调整到$x_{median}\pm5MAD$。



#### 标准化

标准化的处理过程包括标准正态法、加权标准正态法、Box-Cox 变换、Johnson 变换等方法。在BARRA 的风险模型中，采用根号市值加权的标准正态法，在一定程度上剔除了市值的影响，但是这样的方法会造成标准化因子截面的均值不等于0，这在之后的股票组合权重优化的风险敞口设置时会产生一定的偏差，考虑到这点，我们仅采用简单的标准正态法，即：
$$
d_{nl}=\frac{d_{nl}^{raw}-\mu_l}{\sigma_l}
$$
其中，$d_{nl}$为标准化因子序列，$d_{nl}^{raw}$为原始因子序列，$\mu_l$为$d_{nl}^{raw}$算数平均值，$\sigma_l$为$d_{nl}^{raw}$标准差





